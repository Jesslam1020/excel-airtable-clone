name: üöÄ Auto Deploy Excel-Airtable Clone

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - name: üì• Checkout code
        uses: actions/checkout@v4
        
      - name: üì¶ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          cache-dependency-path: packages/cli/excel-airtable-clone/package-lock.json
          
      - name: üîç Check repository structure
        run: |
          echo "Repository root directory: $(pwd)"
          echo "Repository contents:"
          ls -la
          echo "Checking for project directory:"
          test -d packages/cli/excel-airtable-clone && echo "‚úÖ Project directory found" || echo "‚ùå Project directory not found"
          echo "Checking project contents:"
          ls -la packages/cli/excel-airtable-clone/
          
      - name: üîß Install dependencies
        working-directory: packages/cli/excel-airtable-clone
        run: |
          echo "Installing dependencies in: $(pwd)"
          npm ci
          
      - name: üîç Lint code
        working-directory: packages/cli/excel-airtable-clone
        run: |
          echo "Running lint in: $(pwd)"
          npm run lint || echo "Lint failed but continuing..."
        
      - name: üèóÔ∏è Build project
        working-directory: packages/cli/excel-airtable-clone
        run: |
          echo "Building project in: $(pwd)"
          npm run build
        env:
          NEXT_PUBLIC_FIREBASE_API_KEY: ${{ secrets.NEXT_PUBLIC_FIREBASE_API_KEY }}
          NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN: ${{ secrets.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN }}
          NEXT_PUBLIC_FIREBASE_PROJECT_ID: ${{ secrets.NEXT_PUBLIC_FIREBASE_PROJECT_ID }}
          NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET: ${{ secrets.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET }}
          NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID: ${{ secrets.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID }}
          NEXT_PUBLIC_FIREBASE_APP_ID: ${{ secrets.NEXT_PUBLIC_FIREBASE_APP_ID }}
          
      - name: ‚úÖ Build Complete
        run: echo "üéâ Build completed successfully! Add GitHub secrets to enable Vercel deployment."
